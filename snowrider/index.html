<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sled Shred X-TREME</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(#a0e9ff, #ffffff);
      font-family: 'Comic Sans MS', cursive, sans-serif;
    }
    canvas {
      display: block;
    }
    #score {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 36px;
      color: #333;
      background: rgba(255,255,255,0.8);
      padding: 10px 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px #aaa;
    }
    #resetBtn {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      font-size: 20px;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 0 10px #666;
    }
    #resetBtn:hover {
      background: #ff2222;
    }
  </style>
</head>
<body>
<div id="score">Score: 0</div>
<button id="resetBtn">Reset</button>
<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
  let scene = new THREE.Scene();
  scene.fog = new THREE.Fog(0xe0f7fa, 10, 50);

  let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  let renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  // Lighting
  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(10, 20, 10);
  scene.add(light);

  const ambient = new THREE.AmbientLight(0x888888);
  scene.add(ambient);

  // Player (sled)
  let sled = new THREE.Mesh(
    new THREE.BoxGeometry(2, 1, 2),
    new THREE.MeshLambertMaterial({ color: 0xff4444 })
  );
  sled.position.y = 1;
  scene.add(sled);

  // Ground with textured look
  let groundTex = new THREE.TextureLoader().load('https://threejsfundamentals.org/threejs/resources/images/checker.png');
  groundTex.wrapS = groundTex.wrapT = THREE.RepeatWrapping;
  groundTex.repeat.set(50, 50);

  let ground = new THREE.Mesh(
    new THREE.PlaneGeometry(100, 100),
    new THREE.MeshLambertMaterial({ map: groundTex })
  );
  ground.rotation.x = -Math.PI / 2;
  scene.add(ground);

  camera.position.set(0, 10, 15);
  camera.lookAt(0, 0, 0);

  let trees = [];
  let score = 0;
  let scoreEl = document.getElementById("score");
  let gameOver = false;

  function spawnTree() {
    let tree = new THREE.Group();

    let trunk = new THREE.Mesh(
      new THREE.CylinderGeometry(0.3, 0.3, 1, 6),
      new THREE.MeshLambertMaterial({ color: 0x8B4513 })
    );
    trunk.position.y = 0.5;

    let leaves = new THREE.Mesh(
      new THREE.ConeGeometry(1.5, 4, 8),
      new THREE.MeshLambertMaterial({ color: 0x006400 })
    );
    leaves.position.y = 3;

    tree.add(trunk);
    tree.add(leaves);

    tree.position.set((Math.random() - 0.5) * 40, 0, -60);
    scene.add(tree);
    trees.push(tree);
  }

  let keys = {};
  window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
  window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

  document.getElementById("resetBtn").addEventListener("click", () => location.reload());

  function animate() {
    requestAnimationFrame(animate);
    if (gameOver) return;

    if (keys['arrowleft']) sled.position.x -= 0.4;
    if (keys['arrowright']) sled.position.x += 0.4;

    trees.forEach(tree => {
      tree.position.z += 0.5;

      // Check for collision
      let dx = tree.position.x - sled.position.x;
      let dz = tree.position.z - sled.position.z;
      if (Math.sqrt(dx * dx + dz * dz) < 2) {
        gameOver = true;
        scoreEl.textContent = `ðŸ’¥ CRASH! Final Score: ${score}`;
      }
    });

    trees = trees.filter(tree => tree.position.z < 20);

    if (Math.random() < 0.05) spawnTree();

    score++;
    if (!gameOver) scoreEl.textContent = "Score: " + score;

    renderer.render(scene, camera);
  }

  animate();
</script>
</body>
</html>
